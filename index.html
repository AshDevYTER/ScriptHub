<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Script Hub</title>
<link rel="icon" href="logo.png">
<style>
body{margin:0;background:#0b0b0b;color:#fff;font-family:Arial}
header{display:flex;gap:10px;padding:12px;background:#000;position:fixed;width:100%}
button{background:#4fc3f7;border:none;padding:10px 14px;border-radius:10px;font-weight:700}
main{margin-top:70px;padding:20px}
.upload{display:none;background:#111;padding:14px;border-radius:12px}
.scriptEditor{border:1px solid #333;border-radius:10px;padding:10px;margin-bottom:10px;position:relative}
.scriptEditor input,.scriptEditor textarea{width:100%;margin-top:6px;background:#000;color:#fff;border:1px solid #333;border-radius:8px;padding:8px}
.remove{position:absolute;top:6px;right:6px;background:#ff5252;border:none;border-radius:6px}
.card{background:#111;padding:12px;border-radius:12px;margin-bottom:10px;cursor:pointer}
pre{background:#000;padding:10px;border-radius:10px}
</style>
</head>
<body>

<header>
<button id="login">Login</button>
<button id="logout" style="display:none">Logout</button>
</header>

<main>
<div class="upload" id="upload">
<input id="packTitle" placeholder="Pack title">
<div id="editors"></div>
<button onclick="addEditor()">Add Script</button>
<button onclick="savePack()">Save Pack</button>
</div>
<div id="list"></div>
</main>

<script>
const ADMIN_PASSWORD="AshDevYTERISANIMEFUN"
const RAW_URL="https://raw.githubusercontent.com/YOUR_USERNAME/YOUR_REPO/main/scripts.json"
const API_URL="https://api.github.com/repos/YOUR_USERNAME/YOUR_REPO/contents/scripts.json"
const TOKEN="PASTE_TOKEN_HERE"

let users=JSON.parse(localStorage.getItem("users")||"{}")
let user=localStorage.getItem("user")
let packs=[]

login.onclick=()=>{
  let u=prompt("Username")
  let p=prompt("Password")
  if(!users[u]) users[u]={p,admin:p===ADMIN_PASSWORD}
  if(users[u].p!==p) return alert("Wrong")
  user=u
  localStorage.setItem("user",u)
  localStorage.setItem("users",JSON.stringify(users))
  apply()
}
logout.onclick=()=>{localStorage.clear();location.reload()}

function apply(){
  login.style.display="none"
  logout.style.display="block"
  upload.style.display=users[user].admin?"block":"none"
}
if(user&&users[user]) apply()

function addEditor(t="",c=""){
  let d=document.createElement("div")
  d.className="scriptEditor"
  d.innerHTML=`<button class="remove" onclick="this.parentNode.remove()">X</button>
  <input placeholder="Script title" value="${t}">
  <textarea placeholder="Code">${c}</textarea>`
  editors.appendChild(d)
}
addEditor()

async function load(){
  let r=await fetch(RAW_URL)
  packs=await r.json()
  list.innerHTML=""
  packs.forEach((p,i)=>{
    let d=document.createElement("div")
    d.className="card"
    d.textContent=p.title
    d.onclick=()=>alert(JSON.stringify(p,null,2))
    list.appendChild(d)
  })
}
load()

async function savePack(){
  let scripts=[]
  editors.querySelectorAll(".scriptEditor").forEach(e=>{
    let t=e.children[1].value.trim()
    let c=e.children[2].value.trim()
    if(t&&c) scripts.push({title:t,code:c})
  })
  if(!scripts.length) return alert("No scripts")
  packs.unshift({title:packTitle.value,scripts})
  await saveGitHub()
}

async function saveGitHub(){
  let sha=null
  let meta=await fetch(API_URL,{headers:{
    Authorization:"Bearer "+TOKEN,
    Accept:"application/vnd.github+json"
  }})

  if(meta.ok){
    let j=await meta.json()
    sha=j.sha
  }

  let body={
    message:"update scripts",
    content:btoa(unescape(encodeURIComponent(JSON.stringify(packs,null,2))))
  }
  if(sha) body.sha=sha

  let res=await fetch(API_URL,{
    method:"PUT",
    headers:{
      Authorization:"Bearer "+TOKEN,
      Accept:"application/vnd.github+json",
      "Content-Type":"application/json"
    },
    body:JSON.stringify(body)
  })

  if(!res.ok){
    alert("UPLOAD FAILED")
    console.log(await res.text())
    return
  }

  location.reload()
}
</script>
</body>
</html>
